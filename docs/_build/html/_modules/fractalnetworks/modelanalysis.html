<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>fractalnetworks.modelanalysis &#8212; Fractal Networks 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=61cd365c" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=12dfc556" />
    <script src="../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for fractalnetworks.modelanalysis</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;This module analyses the properties of known network models.&quot;&quot;&quot;</span>

<span class="c1"># Other function imports</span>
<span class="kn">from</span> <span class="nn">.modelgenerator</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">.utilities</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c1"># Mathematics modules</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<div class="viewcode-block" id="SHM_no_of_edges">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.SHM_no_of_edges">[docs]</a>
<span class="k">def</span> <span class="nf">SHM_no_of_edges</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the number of edges in an n-th generation SHM network with parameter m.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The number of offspring added at each stage,</span>
<span class="sd">                    as defined by the SHM model (Song, Havlin, and Makse, 2006).</span>
<span class="sd">        n (int) : The number of iterations to perform of the SHM generative process (Song, Havlin, and Makse, 2006).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (int) : The number of edges in the network.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># An SHM network has (1+2m)^(n-1) edges.</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span></div>



<div class="viewcode-block" id="SHM_no_of_nodes">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.SHM_no_of_nodes">[docs]</a>
<span class="k">def</span> <span class="nf">SHM_no_of_nodes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the number of nodes in an n-th generation SHM network with parameter m.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The number of offspring added at each stage,</span>
<span class="sd">                    as defined by the SHM model (Song, Havlin, and Makse, 2006).</span>
<span class="sd">        n (int) : The number of iterations to perform of the SHM generative process  (Song, Havlin, and Makse, 2006).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (int) : The number of nodes in the network.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># An SHM network has (1+2m)^(n-1)+1 nodes.</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span></div>



<div class="viewcode-block" id="check_SHM_no_of_edges">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.check_SHM_no_of_edges">[docs]</a>
<span class="k">def</span> <span class="nf">check_SHM_no_of_edges</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the validity of the number of edges of an SHM network calculating according to analytical arguments in [1]</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The parameter m in the SHM network model (Song, Havlin, and Makse, 2006)</span>
<span class="sd">        n (int) : The parameter n in the SHM network model (Song, Havlin, and Makse, 2006)</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool) : True if the analytical and empirical value agree, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate an SHM network.</span>
    <span class="c1"># The number of edges is independent of the probability p, so p is chosen randomly on the interval [0,1]</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">generate_SHM_model</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">n</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">eG</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>  <span class="c1"># Empirical number of edges</span>
    <span class="n">est_eG</span> <span class="o">=</span> <span class="n">SHM_no_of_edges</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Estimated number of edges</span>

    <span class="c1"># Check if the values are equal</span>
    <span class="k">return</span> <span class="n">eG</span> <span class="o">==</span> <span class="n">est_eG</span></div>



<div class="viewcode-block" id="check_SHM_no_of_nodes">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.check_SHM_no_of_nodes">[docs]</a>
<span class="k">def</span> <span class="nf">check_SHM_no_of_nodes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the validity of the number of nodes of an SHM network calculating according to analytical arguments in [1]</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The parameter m in the SHM network model (Song, Havlin, and Makse, 2006)</span>
<span class="sd">        n (int) : The parameter n in the SHM network model (Song, Havlin, and Makse, 2006)</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool) : True if the analytical and empirical value agree, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate an SHM network.</span>
    <span class="c1"># The number of nodes is independent of the probability p, so p is chosen randomly on the interval [0,1]</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">generate_SHM_model</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">n</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>  <span class="c1"># Empirical number of nodes</span>
    <span class="n">est_N</span> <span class="o">=</span> <span class="n">SHM_no_of_nodes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Estimated number of nodes</span>

    <span class="c1"># Check if the values are equal</span>
    <span class="k">return</span> <span class="n">N</span> <span class="o">==</span> <span class="n">est_N</span></div>



<div class="viewcode-block" id="SHM_p0_degree_prob">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.SHM_p0_degree_prob">[docs]</a>
<span class="k">def</span> <span class="nf">SHM_p0_degree_prob</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the probability P(d) for a given degree d in an SHM network with parameters m, n and p=0.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The parameter m in the SHM network model (Song, Havlin, and Makse, 2006).</span>
<span class="sd">        d (int) : The degree to find the probability density P(d) for.</span>
<span class="sd">        n (int) : The parameter N in the SHM network model (Song, Havlin, and Makse, 2006).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float) : The probability P(d) from the degree distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># The maximum degree in a network with parameters m, N is (1+m)^(N-1) [4].</span>
    <span class="c1"># Thus, for any larger degree d, the probability of a node having degree d is 0.</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="c1"># All degrees in an SHM network with p=0 are powers of (1+m)</span>
    <span class="n">power</span><span class="p">,</span> <span class="n">is_power</span> <span class="o">=</span> <span class="n">exact_log</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">m</span><span class="p">))</span>  <span class="c1"># Check if d is a power of (1+m) and find the exponent.</span>

    <span class="c1"># If d is a power, then we can find P(d).</span>
    <span class="k">if</span> <span class="n">is_power</span><span class="p">:</span>
        <span class="c1"># Nodes added at stage k have degree d = (1+m)^power = (1+m)^(N-k), so k = N-power.</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">power</span>

        <span class="c1"># In the first stage, 2 nodes are added.</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">no_deg_d</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="c1"># In every subsequent stage (1+2m)^(k-1) - (1+2m)^(k-2) nodes are added.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">no_deg_d</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Find the total number of nodes in the network.</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">SHM_no_of_nodes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

        <span class="c1"># The probability that a node has degree d is the number of nodes with degree d divided by the number of nodes.</span>
        <span class="k">return</span> <span class="n">no_deg_d</span> <span class="o">/</span> <span class="n">total</span>

    <span class="c1"># For all other degrees, return 0.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span></div>



<div class="viewcode-block" id="check_SHM_p0_degree_prob">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.check_SHM_p0_degree_prob">[docs]</a>
<span class="k">def</span> <span class="nf">check_SHM_p0_degree_prob</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the accuracy of the calculated degree probability, according to analytical arguments.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The parameter m in the SHM network model (Song, Havlin, and Makse, 2006).</span>
<span class="sd">        d (int) : The degree to find the probability density P(d) for.</span>
<span class="sd">        n (int) : The parameter N in the SHM network model (Song, Havlin, and Makse, 2006).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool) : True if the two values agree, and False if they disagree.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate an SHM network with parameters m, n, p=0.</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">generate_SHM_model</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Find a list of the degrees in the network.</span>
    <span class="n">degrees</span> <span class="o">=</span> <span class="p">[</span><span class="n">deg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">()]</span>

    <span class="c1"># Count the number of nodes with degree d.</span>
    <span class="n">no_deg_d</span> <span class="o">=</span> <span class="n">degrees</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="c1"># The probability that a node has degree d is the number of nodes with degree d divided by the number of nodes.</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">no_deg_d</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">degrees</span><span class="p">)</span>

    <span class="c1"># Find the calculated probability according to the analytical arguments.</span>
    <span class="n">est_prob</span> <span class="o">=</span> <span class="n">SHM_p0_degree_prob</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="c1"># Return True if the values agree, and False if not.</span>
    <span class="k">return</span> <span class="n">prob</span> <span class="o">==</span> <span class="n">est_prob</span></div>



<div class="viewcode-block" id="SHM_p0_degree_dist">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.SHM_p0_degree_dist">[docs]</a>
<span class="k">def</span> <span class="nf">SHM_p0_degree_dist</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the degree distribution of an SHM network with p=0</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The parameter m in the SHM network model to test (Song, Havlin, and Makse, 2006).</span>
<span class="sd">        n (int) : The parameter N in the SHM network model (Song, Havlin, and Makse, 2006).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple) : Tuple containing two lists, specifically:</span>
<span class="sd">                    a list of the degrees in the network;</span>
<span class="sd">                    a list of probabilities of a node having a given degree.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialise empty lists for the degrees and the degree distribution</span>
    <span class="n">degrees</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">degree_dist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Iterate through each of the generative stages 1, 2, ..., N</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="c1"># The degree of a node added at time k is (1+m)^(N-k)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
        <span class="c1"># Add the degree d to the list of degrees.</span>
        <span class="n">degrees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="c1"># Add the probability P(d) to the degree distribution.</span>
        <span class="n">degree_dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SHM_p0_degree_prob</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

    <span class="c1"># Return the list of degrees and the degree distribution.</span>
    <span class="k">return</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">degree_dist</span></div>



<div class="viewcode-block" id="check_SHM_p0_degree_dist">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.check_SHM_p0_degree_dist">[docs]</a>
<span class="k">def</span> <span class="nf">check_SHM_p0_degree_dist</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the accuracy of the calculated degree distribution, according to analytical arguments.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The parameter m in the SHM network model (Song, Havlin, and Makse, 2006).</span>
<span class="sd">        n (int) : The parameter n in the SHM network model (Song, Havlin, and Makse, 2006).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool) : True if the two distributions agree, and False if they disagree.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate an SHM network with parameters m, N, p=0.</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">generate_SHM_model</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Find the degree distribution.</span>
    <span class="n">degrees</span> <span class="o">=</span> <span class="p">[</span><span class="n">deg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">()]</span>

    <span class="c1"># Find a sorted list of degrees without repetition.</span>
    <span class="n">unique_degrees</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">degrees</span><span class="p">))</span>
    <span class="n">unique_degrees</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="c1"># Initialise an empty list for the degree distribution.</span>
    <span class="n">degree_dist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># For each of the degrees, find the number of occurrences and divide that by the total number of nodes.</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">unique_degrees</span><span class="p">:</span>
        <span class="n">no_deg_d</span> <span class="o">=</span> <span class="n">degrees</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="n">no_deg_d</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">degrees</span><span class="p">)</span>
        <span class="c1"># Add the probability to the degree distribution</span>
        <span class="n">degree_dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>

    <span class="c1"># Find the estimated degree distribution according to the analytical arguments.</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">est_degree_dist</span> <span class="o">=</span> <span class="n">SHM_p0_degree_dist</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="c1"># Return True if the distributions are the same, and False otherwise.</span>
    <span class="k">return</span> <span class="n">degree_dist</span> <span class="o">==</span> <span class="n">est_degree_dist</span></div>



<div class="viewcode-block" id="SHM_p1_degree_prob">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.SHM_p1_degree_prob">[docs]</a>
<span class="k">def</span> <span class="nf">SHM_p1_degree_prob</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the probability P(d) for a given degree d in an SHM network with parameters m, N and p=1.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The parameter m in the SHM network model (Song, Havlin, and Makse, 2006).</span>
<span class="sd">        d (int) : The degree to find the probability density P(d) for.</span>
<span class="sd">        n (int) : The parameter n in the SHM network model (Song, Havlin, and Makse, 2006).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (float) : The probability P(d) from the degree distribution.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># The maximum degree in a network with parameters m, N is m^(N-1) [4].</span>
    <span class="c1"># Thus, for any larger degree d, the probability of a node having degree d is 0.</span>
    <span class="k">if</span> <span class="n">d</span> <span class="o">&gt;</span> <span class="n">m</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>

    <span class="c1"># All degrees in an SHM network are powers of m or 2 times a power of m.</span>
    <span class="n">power</span><span class="p">,</span> <span class="n">is_power</span> <span class="o">=</span> <span class="n">exact_log</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>  <span class="c1"># Check if d is a power of m, and find the exponent.</span>
    <span class="n">double_power</span><span class="p">,</span> <span class="n">is_double_power</span> <span class="o">=</span> <span class="n">exact_log</span><span class="p">(</span><span class="n">d</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>  <span class="c1"># Check if 1/2 d is a power of m, and find the exponent.</span>

    <span class="c1"># The only case where d and 1/2 are both powers of m is when m = 2.</span>
    <span class="c1"># In this case, the calculation of the degree distribution is different.</span>
    <span class="k">if</span> <span class="n">is_power</span> <span class="ow">and</span> <span class="n">is_double_power</span><span class="p">:</span>
        <span class="c1"># Find k, where k is the stage that the node is added.</span>
        <span class="c1"># The degree of the node is d=m^(N-k), so if d=m^power, then power = N-k</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">power</span>

        <span class="c1"># If the node was added in the first stage, or if the node was added in the second stage by rewired, then k=1.</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># There are four such nodes, the 2 added in the first stage and the 2 rewired in the second stage.</span>
            <span class="n">no_deg_d</span> <span class="o">=</span> <span class="mi">4</span>

        <span class="c1"># If the node was added in any other stage, then calculate the number of nodes with this degree.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># There are 2(m-1)(1+2m)^(k-2) nodes added in the k-th stage which aren&#39;t rewired,</span>
            <span class="c1">#            and 2(1+2m)^(k-1) nodes added in the (k+1)-th stage which are rewired.</span>
            <span class="n">no_deg_d</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

            <span class="c1"># Find the total number of nodes.</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">SHM_no_of_nodes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="c1"># The probability of a given node having degree d is the number of nodes with that degree</span>
        <span class="c1">#   divided by the total number of nodes.</span>
        <span class="k">return</span> <span class="n">no_deg_d</span> <span class="o">/</span> <span class="n">total</span>

    <span class="c1"># The remaining code deals with all other cases when m != 2.</span>

    <span class="c1"># If d is a power of m, then d is the degree of a node added in the k-th stage which is not rewired,</span>
    <span class="c1">#    where k is such that d = m ^ (n-k)</span>
    <span class="k">elif</span> <span class="n">is_power</span><span class="p">:</span>
        <span class="c1"># Find k</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">power</span>

        <span class="c1"># If the node was added in the first stage then k=1.</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># There are two nodes added in the first stage.</span>
            <span class="n">no_deg_d</span> <span class="o">=</span> <span class="mi">2</span>

        <span class="c1"># Otherwise, the number of nodes added in the k-th stage which aren&#39;t rewired is 2(m-1)(1+2m)^(k-2).</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">no_deg_d</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Find the total number of nodes.</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">SHM_no_of_nodes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="c1"># The probability of a given node having degree d is the number of nodes with</span>
        <span class="c1">#   that degree divided by the total number of nodes.</span>
        <span class="k">return</span> <span class="n">no_deg_d</span> <span class="o">/</span> <span class="n">total</span>

    <span class="c1"># If 1/2 d is a power of m, then d is the degree of a node added in the k-th stage which is rewired,</span>
    <span class="c1">#    where k is such that d = 2 m ^ (n-k)</span>
    <span class="k">elif</span> <span class="n">is_double_power</span><span class="p">:</span>
        <span class="c1"># Find k</span>
        <span class="n">k</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">power</span>

        <span class="c1"># No nodes are rewired in the first stage, so we do not need to consider that case.</span>
        <span class="n">no_deg_d</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c1"># Find the total number of nodes.</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">SHM_no_of_nodes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="c1"># The probability of a given node having degree d is the number of nodes</span>
        <span class="c1">#   with that degree divided by the total number of nodes.</span>
        <span class="k">return</span> <span class="n">no_deg_d</span> <span class="o">/</span> <span class="n">total</span>

    <span class="c1"># If the degree d is a not a power of m, or 1/2 d is not a power of m, then no nodes will have degree d.</span>
    <span class="c1"># Thus, the probability is 0.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span></div>



<div class="viewcode-block" id="check_SHM_p1_degree_prob">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.check_SHM_p1_degree_prob">[docs]</a>
<span class="k">def</span> <span class="nf">check_SHM_p1_degree_prob</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the accuracy of the calculated degree probability, according to analytical arguments.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The parameter m in the SHM network model (Song, Havlin, and Makse, 2006).</span>
<span class="sd">        d (int) : The degree to find the probability density P(d) for.</span>
<span class="sd">        n (int) : The parameter n in the SHM network model (Song, Havlin, and Makse, 2006).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool) : True if the two values agree, and False if they disagree.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate an SHM network with parameters m, N, p=1.</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">generate_SHM_model</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># Find a list of the degrees in the network.</span>
    <span class="n">degrees</span> <span class="o">=</span> <span class="p">[</span><span class="n">deg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">()]</span>

    <span class="c1"># Count the number of nodes with degree d.</span>
    <span class="n">no_deg_d</span> <span class="o">=</span> <span class="n">degrees</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
    <span class="c1"># The probability that a node has degree d is the number of nodes</span>
    <span class="c1">#   with degree d divided by the total number of nodes.</span>
    <span class="n">prob</span> <span class="o">=</span> <span class="n">no_deg_d</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">degrees</span><span class="p">)</span>

    <span class="c1"># Find the calculated probability according to the analytical arguments.</span>
    <span class="n">est_prob</span> <span class="o">=</span> <span class="n">SHM_p1_degree_prob</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="c1"># Return True if the values agree, and False if not.</span>
    <span class="k">return</span> <span class="n">prob</span> <span class="o">==</span> <span class="n">est_prob</span></div>



<div class="viewcode-block" id="SHM_p1_degree_dist">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.SHM_p1_degree_dist">[docs]</a>
<span class="k">def</span> <span class="nf">SHM_p1_degree_dist</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculates the degree distribution of an SHM network with p=1</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int): The parameter m in the SHM network model to test (Song, Havlin, and Makse, 2006)</span>
<span class="sd">        n (int): The parameter n in the SHM network model (Song, Havlin, and Makse, 2006)</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple) : A tuple containing two lists, specifically:</span>
<span class="sd">                    a list of the degrees in the network;</span>
<span class="sd">                    and a list of probabilities of a node having a given degree, where degree_dist[i] is P(degrees[i])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Initialise empty lists for the degrees and degree distribution.</span>
    <span class="n">degrees</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">degree_dist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># The degree distribution behaves different for m=2, so we consider this case separately.</span>
    <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
        <span class="c1"># Iterate through each of the generative stages 1, 2, ..., N</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>
            <span class="c1"># The degree of nodes generated at stage k is m^(N-k)</span>
            <span class="c1"># For m=2, nodes generates at stage k+1 which are rewired also have degree m^(N-k)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">m</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>

            <span class="c1"># Add the degree d to the list of degrees, and the probability P(d) to the degree distribution.</span>
            <span class="n">degrees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">degree_dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SHM_p1_degree_prob</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

    <span class="c1"># The following code deals with the case when m != 2.</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Iterate through each of the generative stages 1, 2, ..., N</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">):</span>

            <span class="c1"># The degree of nodes generated at stage k is m^(N-k)</span>
            <span class="n">d</span> <span class="o">=</span> <span class="n">m</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">)</span>
            <span class="c1"># Add the degree d to the list of degrees, and the probability P(d) to the degree distribution.</span>
            <span class="n">degrees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
            <span class="n">degree_dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SHM_p1_degree_prob</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

            <span class="c1"># For all stages except the first, there are also some nodes which are rewired.</span>
            <span class="c1"># These have degree 2m^(N-k)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">d</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="n">k</span><span class="p">))</span>

                <span class="c1"># Add the degree d to the list of degrees, and the probability P(d) to the degree distribution.</span>
                <span class="n">degrees</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
                <span class="n">degree_dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">SHM_p1_degree_prob</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

    <span class="c1"># Return the list of degrees and the degree distribution.</span>
    <span class="k">return</span> <span class="n">degrees</span><span class="p">,</span> <span class="n">degree_dist</span></div>



<div class="viewcode-block" id="check_SHM_p1_degree_dist">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.check_SHM_p1_degree_dist">[docs]</a>
<span class="k">def</span> <span class="nf">check_SHM_p1_degree_dist</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the accuracy of the calculated degree distribution, according to analytical arguments.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The parameter m in the SHM network model (Song, Havlin, and Makse, 2006).</span>
<span class="sd">        n (int) : The parameter n in the SHM network model (Song, Havlin, and Makse, 2006).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool) : True if the two distributions agree, and False if they disagree.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate an SHM network with parameters m, N, p=1.</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">generate_SHM_model</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># Find the degree distribution.</span>
    <span class="n">degrees</span> <span class="o">=</span> <span class="p">[</span><span class="n">deg</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">deg</span> <span class="ow">in</span> <span class="n">G</span><span class="o">.</span><span class="n">degree</span><span class="p">()]</span>

    <span class="c1"># Find a sorted list of degrees without repetition.</span>
    <span class="n">unique_degrees</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">degrees</span><span class="p">))</span>
    <span class="n">unique_degrees</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>

    <span class="c1"># Initialise an empty list for the degree distribution.</span>
    <span class="n">degree_dist</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># For each of the degrees, find the number of occurrences and divide that by the total number of nodes.</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">unique_degrees</span><span class="p">:</span>
        <span class="n">no_deg_d</span> <span class="o">=</span> <span class="n">degrees</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="n">prob</span> <span class="o">=</span> <span class="n">no_deg_d</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">degrees</span><span class="p">)</span>
        <span class="c1"># Add the probability to the degree distribution</span>
        <span class="n">degree_dist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prob</span><span class="p">)</span>

    <span class="c1"># Find the estimated degree distribution according to the analytical arguments.</span>
    <span class="n">_</span><span class="p">,</span> <span class="n">est_degree_dist</span> <span class="o">=</span> <span class="n">SHM_p1_degree_dist</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="c1"># Return True if the distributions are the same, and False otherwise.</span>
    <span class="k">return</span> <span class="n">degree_dist</span> <span class="o">==</span> <span class="n">est_degree_dist</span></div>



<div class="viewcode-block" id="check_SHM_p0_lambda">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.check_SHM_p0_lambda">[docs]</a>
<span class="k">def</span> <span class="nf">check_SHM_p0_lambda</span><span class="p">(</span><span class="n">m_max</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Verifies that the analytical result for lambda agrees with the empirical result (Song, Havlin, and Makse, 2006).</span>

<span class="sd">    Args:</span>
<span class="sd">        m_max (int)                     : The maximum value of parameter m in the SHM network model to test.</span>
<span class="sd">        n (int)                         : The parameter n in the SHM network model.</span>
<span class="sd">        plot (:obj:`bool`, optional)    : If True, plots a comparison of the results. Default is False.</span>
<span class="sd">        verbose (:obj:`bool`, optional) : If True, prints results to terminal. Default is False.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (tuple) : Tuple containing two lists, specifically:</span>
<span class="sd">                    a list of the values of lambda found by fitting a power law distribution to empirical data;</span>
<span class="sd">                    and a list of the values of lambda determined by the analytical argument.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Initialise empty lists to store the empirical and analytical results.</span>
    <span class="n">empirical</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">analytical</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Create a list of all possible values of m</span>
    <span class="n">ms</span> <span class="o">=</span> <span class="p">[</span><span class="n">m</span> <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">m_max</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span>

    <span class="c1"># Iterate over each possible m</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">ms</span><span class="p">:</span>
        <span class="c1"># Find the degree distribution</span>
        <span class="n">degrees</span><span class="p">,</span> <span class="n">degree_dist</span> <span class="o">=</span> <span class="n">SHM_p0_degree_dist</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="c1"># Fit a power law curve to the distribution and find the parameters characterising the best fit</span>
        <span class="n">best_fit</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">find_best_power_law_fit</span><span class="p">(</span><span class="n">degrees</span><span class="p">,</span> <span class="n">degree_dist</span><span class="p">,</span> <span class="n">A_min</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">A_max</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">c_min</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">c_max</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
                                              <span class="n">linspace_N</span><span class="o">=</span><span class="mi">1001</span><span class="p">)</span>
        <span class="c1"># Calculate the estimated value of lambda according to analytical results.</span>
        <span class="n">est_lambda</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">m</span><span class="p">)</span>

        <span class="c1"># Add the results to their respective lists.</span>
        <span class="n">empirical</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best_fit</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">analytical</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">est_lambda</span><span class="p">)</span>

    <span class="c1"># If verbose is True print the results.</span>
    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Analytical Result&quot;</span><span class="p">,</span> <span class="n">analytical</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Empirical Result&quot;</span><span class="p">,</span> <span class="n">empirical</span><span class="p">)</span>

    <span class="c1"># If plot is True plot the results.</span>
    <span class="k">if</span> <span class="n">plot</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">analytical</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Analytical Result&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ms</span><span class="p">,</span> <span class="n">empirical</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Empirical Result&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;crimson&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Degree Distribution of the Song-Havlin-Makse Network with $p=0$&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Comparison of Power Law Coefficient $\lambda$ found by Empirical and Analytical Methods&quot;</span><span class="p">,</span>
                  <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$m$&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;$\lambda$&quot;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Return the results from both methods as lists.</span>
    <span class="k">return</span> <span class="n">empirical</span><span class="p">,</span> <span class="n">analytical</span></div>



<div class="viewcode-block" id="HADG_no_of_edges">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.HADG_no_of_edges">[docs]</a>
<span class="k">def</span> <span class="nf">HADG_no_of_edges</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the number of edges in an n-th generation HADG network with parameter m (Kuang et al., 2013).</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The number of offspring added at each stage, as defined by the HADG model (Kuang et al., 2013).</span>
<span class="sd">        n (int) : The number of iterations to perform of the HADG generative process (Kuang et al., 2013).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (int) : The number of edges in the network.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># A HADG network has (3+2m)^(n-1) edges.</span>
    <span class="k">return</span> <span class="p">(</span><span class="mi">3</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span></div>



<div class="viewcode-block" id="HADG_no_of_nodes">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.HADG_no_of_nodes">[docs]</a>
<span class="k">def</span> <span class="nf">HADG_no_of_nodes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the number of nodes in an n-th generation HADG network with parameter m (Kuang et al., 2013).</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The number of offspring added at each stage, as defined by the HADG model (Kuang et al., 2013).</span>
<span class="sd">        n (int) : The number of iterations to perform of the HADG generative process (Kuang et al., 2013).</span>

<span class="sd">    Returns:</span>
<span class="sd">        N (int) : The number of nodes in the network.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate the number of nodes</span>
    <span class="n">N</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">N</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">N</span></div>



<div class="viewcode-block" id="check_HADG_no_of_edges">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.check_HADG_no_of_edges">[docs]</a>
<span class="k">def</span> <span class="nf">check_HADG_no_of_edges</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the validity of the number of edges of a HADG network calculating according to analytical arguments.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The parameter m in the HADG network model (Kuang et al., 2013).</span>
<span class="sd">        n (int) : The parameter n in the HADG network model (Kuang et al., 2013).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool) : True if the analytical and empirical value agree, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate an SHM network.</span>
    <span class="c1"># The number of edges is independent of the parameters a, b and T, so they are chosen randomly on the interval [0,1]</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">generate_HADG_model</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">n</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">eG</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>  <span class="c1"># Empirical number of edges</span>
    <span class="n">est_eG</span> <span class="o">=</span> <span class="n">HADG_no_of_edges</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Estimated number of edges</span>

    <span class="c1"># Check if the values are equal</span>
    <span class="k">return</span> <span class="n">eG</span> <span class="o">==</span> <span class="n">est_eG</span></div>



<div class="viewcode-block" id="check_HADG_no_of_nodes">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.check_HADG_no_of_nodes">[docs]</a>
<span class="k">def</span> <span class="nf">check_HADG_no_of_nodes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the validity of the number of nodes of a HADG network calculating according to analytical arguments.</span>

<span class="sd">    Args:</span>
<span class="sd">        m (int) : The parameter m in the HADG network model (Kuang et al., 2013).</span>
<span class="sd">        n (int) : The parameter n in the HADG network model (Kuang et al., 2013).</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool) : True if the analytical and empirical value agree, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate an SHM network.</span>
    <span class="c1"># The number of edges is independent of the parameters a, b and T, so they are chosen randomly on the interval [0,1]</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">generate_HADG_model</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(),</span> <span class="n">n</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>  <span class="c1"># Empirical number of edges</span>
    <span class="n">est_N</span> <span class="o">=</span> <span class="n">HADG_no_of_nodes</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Estimated number of edges</span>

    <span class="c1"># Check if the values are equal</span>
    <span class="k">return</span> <span class="n">N</span> <span class="o">==</span> <span class="n">est_N</span></div>



<div class="viewcode-block" id="uv_flower_no_of_edges">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.uv_flower_no_of_edges">[docs]</a>
<span class="k">def</span> <span class="nf">uv_flower_no_of_edges</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the number of edges in an n-th generation (u,v)-flower network (Rozenfeld, Havlin, and ben-Avraham, 2007).</span>

<span class="sd">    Args:</span>
<span class="sd">        u (int) : Value of u, i.e. path length of one of the parallel paths.</span>
<span class="sd">        v (int) : Value of v, i.e. path length of one of the parallel paths.</span>
<span class="sd">        n (int) : Number of generations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (int) : The number of edges in the network.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># A (u,v)-flower has (u+v)^n edges.</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">u</span> <span class="o">+</span> <span class="n">v</span><span class="p">)</span> <span class="o">**</span> <span class="n">n</span></div>



<div class="viewcode-block" id="uv_flower_no_of_nodes">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.uv_flower_no_of_nodes">[docs]</a>
<span class="k">def</span> <span class="nf">uv_flower_no_of_nodes</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Finds the number of nodes in an n-th generation (u,v)-flower network (Rozenfeld, Havlin, and ben-Avraham, 2007).</span>

<span class="sd">    Args:</span>
<span class="sd">        u (int) : Value of u, i.e. path length of one of the parallel paths.</span>
<span class="sd">        v (int) : Value of v, i.e. path length of one of the parallel paths.</span>
<span class="sd">        n (int) : Number of generations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (int) : The number of nodes in the network.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Calculate the number of nodes</span>

    <span class="n">w</span> <span class="o">=</span> <span class="n">u</span> <span class="o">+</span> <span class="n">v</span>
    <span class="k">return</span> <span class="nb">int</span><span class="p">(((</span><span class="n">w</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="p">(</span><span class="n">w</span> <span class="o">**</span> <span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">w</span> <span class="o">/</span> <span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span></div>



<div class="viewcode-block" id="check_uv_flower_no_of_edges">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.check_uv_flower_no_of_edges">[docs]</a>
<span class="k">def</span> <span class="nf">check_uv_flower_no_of_edges</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the validity of the number of edges of a (u,v)-flower network calculating according to analytical arguments.</span>

<span class="sd">    Args:</span>
<span class="sd">        u (int) : Value of u, i.e. path length of one of the parallel paths.</span>
<span class="sd">        v (int) : Value of v, i.e. path length of one of the parallel paths.</span>
<span class="sd">        n (int) : Number of generations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool) : True if the analytical and empirical value agree, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate a (u,v)-flower network</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">generate_uv_flower</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="n">eG</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>  <span class="c1"># Empirical number of edges</span>
    <span class="n">est_eG</span> <span class="o">=</span> <span class="n">uv_flower_no_of_edges</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Estimated number of edges</span>

    <span class="c1"># Check if the values are equal</span>
    <span class="k">return</span> <span class="n">eG</span> <span class="o">==</span> <span class="n">est_eG</span></div>



<div class="viewcode-block" id="check_uv_flower_no_of_nodes">
<a class="viewcode-back" href="../../fractalnetworks.html#fractalnetworks.modelanalysis.check_uv_flower_no_of_nodes">[docs]</a>
<span class="k">def</span> <span class="nf">check_uv_flower_no_of_nodes</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Checks the validity of the number of nodes of a (u,v)-flower network calculating according to analytical arguments.</span>

<span class="sd">    Args:</span>
<span class="sd">        u (int) : Value of u, i.e. path length of one of the parallel paths.</span>
<span class="sd">        v (int) : Value of v, i.e. path length of one of the parallel paths.</span>
<span class="sd">        n (int) : Number of generations.</span>

<span class="sd">    Returns:</span>
<span class="sd">        (bool) : True if the analytical and empirical value agree, False otherwise.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Generate a (u,v)-flower network.</span>
    <span class="n">G</span> <span class="o">=</span> <span class="n">generate_uv_flower</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">G</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>  <span class="c1"># Empirical number of edges</span>
    <span class="n">est_N</span> <span class="o">=</span> <span class="n">uv_flower_no_of_nodes</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>  <span class="c1"># Estimated number of edges</span>

    <span class="c1"># Check if the values are equal</span>
    <span class="k">return</span> <span class="n">N</span> <span class="o">==</span> <span class="n">est_N</span></div>

</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">Fractal Networks</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">fractalnetworks</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Katherine Hamilton.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.3.7</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
    </div>

    

    
  </body>
</html>